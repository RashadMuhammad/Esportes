<!DOCTYPE html>
<html lang="en">

<head>
	<title>Esportes</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--===============================================================================================-->
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/iconic/css/material-design-iconic-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/fonts/linearicons-v1.0.0/icon-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/daterangepicker/daterangepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/slick/slick.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/MagnificPopup/magnific-popup.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/vendor/perfect-scrollbar/perfect-scrollbar.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="/css/util.css">
	<link rel="stylesheet" type="text/css" href="/css/main.css">
	<!--===============================================================================================-->

	<style>
		.modal-content {
			border-radius: 10px;
			box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.1);
		}

		.modal-header {
			background-color: #f8f9fa;
			border-bottom: 1px solid #e9ecef;
			padding: 20px;
		}

		.modal-header h5 {
			font-weight: 600;
		}

		.modal-body img {
			max-width: 100%;
			border-radius: 5px;
			transition: transform 0.3s ease;
		}

		.modal-body img:hover {
			transform: scale(1.05);
		}

		.modal-body p {
			color: #6c757d;
			font-size: 16px;
		}

		.modal-footer {
			border-top: 1px solid #e9ecef;
			padding: 15px;
			justify-content: space-between;
		}

		.btn-primary {
			background-color: #007bff;
			border-color: #007bff;
			transition: all 0.3s ease;
		}

		.btn-primary:hover {
			background-color: #0056b3;
			border-color: #0056b3;
		}

		.btn-secondary {
			background-color: #6c757d;
			transition: background-color 0.3s ease;
		}

		.btn-secondary:hover {
			background-color: #5a6268;
		}

		#sizeSelect,
		#quantitySelect {
			border-radius: 5px;
		}


		.thumbnail-images img {
			cursor: pointer;
			margin-right: 5px;
		}

		.modal.fade .modal-dialog {
			opacity: 0;
			transition: opacity 0.15s linear;
		}

		.modal-body {
			max-height: 170vh;
			/* Limits the height of the modal body */
			overflow-y: auto;
			/* Adds scroll if content overflows */
		}

		.custom-modal {
			margin-top: 50px;
			/* Adjust this value as needed */
		}

		.modal.show .modal-dialog {
			opacity: 1;
		}

		.modal {
			z-index: 1050;
			/* Higher than the default navbar z-index */
		}

		.wrap-menu-desktop {
			z-index: 1000;
			/* Lower than modal */
		}

		.modal-backdrop {
			z-index: 1040;
			/* Below the modal but above the navbar */
			opacity: 0.5;
			/* Adjust for more/less opacity */
		}

		.wrap-pic-w {
			position: relative;
			overflow: visible;
			/* Ensure zoomed view is not clipped */
		}

		.zoomed-view {
			position: absolute;
			width: 150px;
			/* Adjust the size of the zoomed view */
			height: 150px;
			border: 2px solid #000;
			display: none;
			/* Hidden until hovering */
			background: rgba(255, 255, 255, 0.8);
			pointer-events: none;
			/* Disable interaction with the zoomed area */
			background-size: 200%;
			/* Make background image larger for zoom effect */
			z-index: 9999;
			/* Ensure it appears in front of other elements */
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			/* Optional shadow for better visibility */
		}

		.rating {
			direction: rtl;
			/* Makes it easy to fill stars from left to right */
			display: inline-flex;
		}

		.fa-star {
			font-size: 20px;
			/* Adjust star size */
			color: lightgray;
			/* Default color */
		}

		.fa-star.checked {
			color: gold;
			/* Color for checked stars */
		}
	</style>
</head>

<body class="animsition">

	<!-- Header -->
    <%- include('../partials/_header') %>
	

	<!-- breadcrumb -->
	<div class="container pt-5 mt-5">
		<div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
			<a href="/" class="stext-109 cl8 hov-cl1 trans-04">
				Home
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<a href="/product" class="stext-109 cl8 hov-cl1 trans-04">
				shop
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<span class="stext-109 cl4">
				<%= product.name %>
			</span>
		</div>
	</div>



	<!-- Product -->
	<section class="bg0 p-t-23 px-3">
		<div class="container">
			<!-- Section Title -->
			<div class="p-b-10 px-4">
				<h3 class="ltext-103 cl5">
					Product Details
				</h3>
			</div>

			<div class="row mt-5">
				<!-- First Column: Image Gallery -->
				<div class="col-md-6 col-lg-7 p-b-30">
					<div class="p-l-25 p-r-30 p-lr-0-lg">
						<div class="wrap-slick3 flex-sb flex-w">
							<div class="wrap-slick3-dots"></div>
							<div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

							<!-- Slick3 Image Gallery -->
							<div class="slick3 gallery-lb">
								<% if (product.images && product.images.length> 0) { %>
									<% product.images.forEach((image)=> { %>
										<div class="item-slick3" data-thumb="/uploads/<%= image %>">
											<div class="wrap-pic-w pos-relative">
												<img src="/uploads/<%= image %>" alt="IMG-PRODUCT"
													class="img-fluid zoom-img" data-image="/uploads/<%= image %>"
													onmouseover="showZoom(this)" onmouseout="hideZoom(this)">
												<div class="zoomed-view" id="zoomedView"></div>
												<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04"
													href="/uploads/<%= image %>">
													<i class="fa fa-expand"></i>
												</a>
											</div>
										</div>
										<% }) %>
											<% } else { %>
												<p>No images available for this product.</p>
												<% } %>
							</div>
						</div>
					</div>
				</div>

				<!-- Second Column: Product Details -->
				<div class="col-md-6 col-lg-5 p-b-30">
					<div class="p-l-25 p-r-30 p-lr-0-lg">
						<!-- Product Name -->
						<h4 class="mtext-100 cl2 js-name-detail p-b-14">
							<%= product.name %>
						</h4>
				
						<!-- Rating Stars -->
						<div class="rating p-b-14">
							<% for (let i=1; i <= 5; i++) { %>
								<span class="fa fa-star <%= i <= product.rating ? 'checked' : '' %>"></span>
							<% } %>
						</div>
				
						<!-- Product Description -->
						<p class="stext-102 cl3 p-t-20">
							<%= product.description %>
						</p>
				
						<!-- Product Price -->
						<span class="stext-105 cl3">
							<% if (product.discountedPrice===product.price) { %>
								<%= '₹ ' + product.price %>
									<% }else{ %>
										<%= product.discountedPrice ? '₹ ' + product.discountedPrice
											: '₹ ' + product.price %>
											<span class="original-price"
												style="text-decoration: line-through; color: red;">
												₹ <%= product.price %>
											</span>
											<% } %>
						</span>
				
						<!-- Category Information -->
						<p class="category-info stext-105 cl3 p-t-5">
							<%= product.category ? product.category.name : 'Uncategorized' %>
						</p>
				
						<!-- Stock Information (Red color for out of stock) -->
						<p class="stock-info stext-105 cl3 p-t-5" style="color: red;">
							<%= product.stock > 0 ? product.stock + ' items available' : 'Out of stock' %>
						</p>
				
						<!-- Add to Cart Button -->
						<div class="p-t-33">
							<form id="addToCartForm" method="POST">
								<input type="hidden" id="productId" name="productId" value="<%= product._id %>">
								<input type="hidden" id="productStock" value="<%= product.stock %>">
								
								<button type="submit"
									class="btn btn-primary btn-md shadow-lg <%= product.stock <= 0 ? 'disabled' : '' %>"
									<% if (product.stock <= 0) { %>
										onclick="event.preventDefault(); showOutOfStockAlert();"
									<% } %>>
									Add to Cart
								</button>
							</form>
						</div>
				
						<!-- Review Text Area -->
						<div class="p-t-20">
							<label for="review" class="stext-105 cl3">Write a review:</label>
							<textarea id="review" class="form-control" rows="4" placeholder="Share your thoughts about the product"></textarea><br>
							<button class="btn btn-success btn-md p-t-10">Submit Review</button>
						</div>
					</div>
				</div>
				

			</div>
		</div>

		<!-- Load more -->
		<div class="flex-c-m flex-w w-full p-t-45 pb-5">
			<a href="#" class="flex-c-m stext-101 cl5 size-103 bg2 bor1 hov-btn1 p-lr-15 trans-04">
				Load More
			</a>
		</div>
		</div>
		</div>

		<%- include('../partials/_footer') %>

			<!-- Back to top -->
			<div class="btn-back-to-top" id="myBtn">
				<span class="symbol-btn-back-to-top">
					<i class="zmdi zmdi-chevron-up"></i>
				</span>
			</div>



			<script>
				// Add event listener for form submission
				const addToCartForm = document.getElementById('addToCartForm');
				const productId = document.getElementById('productId').value;  // Fetch product ID
				const productStock = document.getElementById('productStock').value; // Fetch stock value

				addToCartForm.addEventListener('submit', async function (event) {
					event.preventDefault(); // Prevent form redirection

					// If stock is 0 or less, show out of stock alert
					if (productStock <= 0) {
						Swal.fire({
							icon: 'error',
							title: 'Out of Stock',
							text: 'This product is currently unavailable.',
						});
					} else {
						// Proceed with adding to cart via AJAX
						await fetch('/add-to-cart', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({ productId: productId })  // Send product ID
						})
							.then(response => response.json())
							.then(data => {
								console.log(data);

								if (data.success) {
									// Show success alert
									Swal.fire({
										icon: 'success',
										title: 'Added to Cart',
										text: 'The product has been successfully added to your cart.',
									});
								} else if (data.limitedStock) {
									// Show limited stock alert
									Swal.fire({
										icon: 'warning',
										title: 'Limited Stock',
										text: 'Only a limited number of this product can be added to your cart.',
									});
								}
							})
							.catch(error => {
								console.log(error);

								Swal.fire({
									icon: 'error',
									title: 'Error',
									text: 'There was a problem adding the product to the cart.',
								});
							});
					}
				});
			</script>


			<!--===============================================================================================-->
			<script src="/vendor/jquery/jquery-3.2.1.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/animsition/js/animsition.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/bootstrap/js/popper.js"></script>
			<script src="/vendor/bootstrap/js/bootstrap.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/select2/select2.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/daterangepicker/moment.min.js"></script>
			<script src="/vendor/daterangepicker/daterangepicker.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/slick/slick.min.js"></script>
			<script src="/js/slick-custom.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/parallax100/parallax100.js"></script>
			<script>$('.parallax100').parallax100();</script>
			<!--===============================================================================================-->
			<script src="/vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/isotope/isotope.pkgd.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/sweetalert/sweetalert.min.js"></script>
			<!--===============================================================================================-->
			<script src="/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
			<script src="/js/main.js"></script>
			<script src="/userjs/product-details.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
			<script>
				function showOutOfStockAlert() {
					Swal.fire({
						icon: 'warning',
						title: 'Out of Stock',
						text: 'Sorry, this product is currently out of stock!',
						confirmButtonText: 'OK'
					});
				}
			</script>

</body>

</html>