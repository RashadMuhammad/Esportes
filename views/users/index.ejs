<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Cache-Control" content="no-store" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<title>Esportes</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">

	<!--===============================================================================================-->
	<!-- <link rel="icon" type="image/png" href="images/icons/favicon.png" /> -->
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">
	<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<!--===============================================================================================-->
	<style>
		.isotope-grid {
			display: flex;
			flex-wrap: wrap;
			gap: 20px;
			/* Adjust as needed */
		}

		.block2 {
			display: flex;
			flex-direction: column;
			height: 100%;
			/* border: 1px solid #ddd; Optional: for visual separation */
			/* border-radius: 8px; Optional: for rounded corners */
			overflow: hidden;
			/* Ensures content does not overflow */
			/* box-shadow: 0 4px 8px rgba(0,0,0,0.1); Optional: for shadow effect */
			background-color: #fff;
			/* Optional: background color */
		}

		.block2-pic {
			position: relative;
			width: 100%;
			height: 200px;
			/* Adjust height as needed */
			overflow: hidden;
		}

		.block2-pic img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			/* Ensures images cover the area */
		}

		.block2-txt {
			padding: 15px;
			/* Adjust padding as needed */
		}

		.block2-txt-child1 {
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			height: 100%;
		}

		.block2-btn {
			position: absolute;
			bottom: 10px;
			left: 50%;
			transform: translateX(-50%);
			background-color: #333;
			/* Button color */
			color: #fff;
			/* Button text color */
			padding: 10px 20px;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			text-align: center;
		}

		.block2-btn:hover {
			background-color: #555;
			/* Button hover color */
		}

		.out-of-stock {
			position: relative;
			opacity: 0.6;
			/* Makes the item look faded */
			pointer-events: none;
			/* Prevents any interaction */
		}



		/* Shade overlay for out-of-stock products */
		.out-of-stock-shade {
			position: relative;
			/* Make sure the shade is relative to the product image */
		}

		.out-of-stock-shade::after {
			content: "";
			/* Create the shade layer */
			position: absolute;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0, 0, 0, 0.4);
			/* Semi-transparent black shade */
			z-index: 1;
			/* Ensure it appears over the product image */
			pointer-events: none;
			/* Allows interaction with underlying elements like the button */
		}

		.out-of-stock {
			color: red;
			/* Change the color to red */
			font-weight: bold;
			/* Optional: Make it bold for emphasis */
		}
	</style>
</head>

<body class="animsition">

	<!-- Header -->
	<%- include('../partials/_header') %>



		<!-- Slider -->
		<section class="section-slide">
			<div class="wrap-slick1">
				<div class="slick1">
					<div class="item-slick1">
						<div class="item-slick1" style="background-image: url(images/main.jpg)">
							<div class="container h-full">
								<div class="flex-col-l-m h-full p-t-100 p-b-30 respon5">
									<div class="layer-slick1 animated visible-false" data-appear="fadeInDown"
										data-delay="0">
										<span class="ltext-101 cl2 respon2" style="color:white">
											Sports Collection 2024
										</span>
									</div>

									<div class="layer-slick1 animated visible-false" data-appear="fadeInUp"
										data-delay="800">
										<h2 class="ltext-201 cl2 p-t-19 p-b-43 respon1" style="color:white">
											Never Ever Give Up
										</h2>
									</div>

									<div class="layer-slick1 animated visible-false" data-appear="zoomIn"
										data-delay="1600">
										<a href="/product"
											class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04">
											Shop Now
										</a>
									</div>
								</div>
							</div>
						</div>

					</div>
				</div>
		</section>


		<!-- Banner -->

		<div class="sec-banner bg0 p-t-80 p-b-50">
			<div class="container">
				<div class="p-b-10">
					<h3 class="ltext-103 cl5">Categories</h3>
				</div>
				<br>
				<div class="row">
					<!-- Loop through categories array and only display listed categories -->
					<% if (!!categories.length> 0) { %>
						<% categories.forEach(function(category) { %>
							<% if (category.isListed) { %>
								<div class="col-md-6 col-xl-4 p-b-30 m-lr-auto">
									<!-- Block1 -->
									<div class="block1 wrap-pic-w">
										<img src="/uploads/<%= category.image %>" style="height: 462px"
											alt="IMG-BANNER">
										<a href="/product/category/<%= category._id %>"
											class="block1-txt ab-t-l s-full flex-col-l-sb p-lr-38 p-tb-34 trans-03 respon3">
											<div class="block1-txt-child1 flex-col-l">
												<span class="block1-name ltext-102 trans-04 p-b-8">
													<%= category.name %>
												</span>
												<span class="block1-info stext-102 trans-04">
													<%= category.description %>
												</span>
											</div>
											<div class="block1-txt-child2 p-b-4 trans-05">
												<div class="block1-link stext-101 cl0 trans-09">
													Shop Now
												</div>
											</div>
										</a>
									</div>
								</div>
								<% } %>
									<% }); %>
										<% } else { %>
											<p>No categories found</p>
											<% } %>
				</div>
			</div>
		</div>


		<!-- Product -->
		<section class="bg0 p-t-23 p-b-140">
			<div class="container">
				<div class="p-b-10">
					<h3 class="ltext-103 cl5">
						Products Overview
					</h3>
				</div>

				<div class="flex-w flex-sb-m p-b-52">
					<!-- Filter Buttons Container -->
					<div class="flex-w flex-l-m filter-tope-group m-tb-10">
						<button class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5 how-active1" data-filter="*">
							All Products
						</button>

						<% categories.forEach(category=> { %>
							<button class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5 filter-button"
								data-filter=".category-<%= category._id %>">
								<%= category.name %>
							</button>
							<% }) %>
					</div>
				</div>

				<!-- Product Grid -->
				<div class="product-container row isotope-grid" id="product-container2">
					<% products.forEach(product=> { %>
						<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item category-<%= product.category._id %>"
							data-rating="<%= product.averageRating %>"
							data-created-at="<%= product.createdAt.toISOString() %>">
							<!-- Block2 -->
							<div class="block2">
								<div class="block2-pic hov-img0 <%= product.stock <= 0 ? 'out-of-stock-shade' : '' %>">
									<% if (product.images && product.images.length> 0) { %>
										<img src="/uploads/<%= product.images[0] %>" alt="IMG-PRODUCT">
										<% } else { %>
											<img src="/path/to/default-image.jpg" alt="Default Image">
											<% } %>
												<a href="/product-detail/<%= product._id %>"
													class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04"
													data-id="<%= product._id %>"> View Details </a>
								</div>

								<div class="block2-txt flex-w flex-t p-t-14">
									<% if (product.stock <=0) { %>
										<span class="stext-105 cl3 out-of-stock">Out of Stock</span>
										<% } %>

											<div class="block2-txt-child1 flex-col-l">
												<a href="/product-detail/<%= product._id %>"
													class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6 card-title">
													<%= product.name %>
												</a>

												<!-- Original and Discounted Price -->
												<span class="stext-105 cl3">
													<% if (product.discountedPrice===product.price) { %>
														₹ <%= product.price %>
															<% } else { %>
																₹ <%= product.discountedPrice ? product.discountedPrice
																	: product.price %>
																	<span class="original-price"
																		style="text-decoration: line-through; color: red;">
																		₹ <%= product.price %>
																	</span>
																	<% } %>
												</span>

												<!-- Wishlist Button -->
												<button
													class="align-items-center wishlist-btn flex-c-m stext-103 cl2 py-2 bg0 bor2 trans-04"
													data-product-id="<%= product._id %>"
													onclick="addToWishlist('<%= product._id %>')">
													<i class="fa fa-heart" aria-hidden="true"></i>
												</button>
											</div>
								</div>
							</div>
						</div>
						<% }) %>
				</div>
			</div>

			<div class="flex-c-m flex-w w-full p-t-45">
				<a href="#" class="flex-c-m stext-101 cl5 size-103 bg2 bor1 hov-btn1 p-lr-15 trans-04">
					Load More
				</a>
			</div>

		</section>


		<script>
			// Add event listeners to each filter button
			document.querySelectorAll('.filter-button').forEach(button => {
				button.addEventListener('click', function () {
					const filterValue = this.getAttribute('data-filter');

					// Get all product elements
					const products = document.querySelectorAll('.isotope-item');

					// Loop through each product and apply the filter
					products.forEach(product => {
						if (filterValue === '*' || product.matches(filterValue)) {
							product.style.display = 'block'; // Show matched products
						} else {
							product.style.display = 'none';  // Hide non-matched products
						}
					});

					// Optionally: Add active class for the clicked button
					document.querySelectorAll('.filter-button').forEach(btn => {
						btn.classList.remove('how-active1');
					});
					this.classList.add('how-active1');
				});
			});
		</script>

		<script>
			async function addToWishlist(productId) {
				try {
					const response = await fetch('/wishlist/add', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({ productId })
					});

					if (response.ok) {
						const result = await response.json();
						if (result.success) {
							// SweetAlert for success
							Swal.fire({
								icon: 'success',
								title: 'Added to Wishlist!',
								text: 'The product has been added to your wishlist.',
								//   showConfirmButton: false,
								//   timer: 1500
							});
						} else {
							// SweetAlert for error
							Swal.fire({
								icon: 'error',
								title: 'Oops...',
								text: result.message || 'Something went wrong!',
							});
						}
					} else {
						// SweetAlert for request failure
						Swal.fire({
							icon: 'error',
							title: 'Failed to add',
							text: 'Product is already exists in wishlist.',
						});
					}
				} catch (error) {
					console.error('Error:', error);
					// SweetAlert for catching unexpected errors
					Swal.fire({
						icon: 'error',
						title: 'Error!',
						text: 'An error occurred while adding the product to the wishlist.',
					});
				}
			}
		</script>

		<script src="vendor/sweetalert/sweetalert.min.js"></script>


		<%- include('../partials/_footer') %>


			<!-- Back to top -->
			<div class="btn-back-to-top" id="myBtn">
				<span class="symbol-btn-back-to-top">
					<i class="zmdi zmdi-chevron-up"></i>
				</span>
			</div>


			<!-- Modal for Quick View -->
			<div class="modal fade" id="quickViewModal" tabindex="-1" role="dialog"
				aria-labelledby="quickViewModalLabel" aria-hidden="true">
				<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="quickViewModalLabel">Product Details</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">
							<div class="row">
								<div class="col-md-6">
									<!-- Main product image with a slider for additional images -->
									<div id="productImagesCarousel" class="carousel slide" data-ride="carousel">
										<div class="carousel-inner">
											<% if (products.images && product.images.length> 0) { %>
												<% product.images.forEach((image, index)=> { %>
													<div class="carousel-item <%= index === 0 ? 'active' : '' %>">
														<img class="d-block w-100" src="/uploads/<%= image %>"
															alt="Product Image">
													</div>
													<% }) %>
														<% } else { %>
															<div class="carousel-item active">
																<p>No images available</p>
															</div>
															<% } %>
										</div>
										<a class="carousel-control-prev" href="#productImagesCarousel" role="button"
											data-slide="prev">
											<span class="carousel-control-prev-icon" aria-hidden="true"></span>
											<span class="sr-only">Previous</span>
										</a>
										<a class="carousel-control-next" href="#productImagesCarousel" role="button"
											data-slide="next">
											<span class="carousel-control-next-icon" aria-hidden="true"></span>
											<span class="sr-only">Next</span>
										</a>
									</div>
								</div>

								<div class="col-md-6">
									<!-- Product Information -->
									<h4 id="productName">
										<%= products.name %>
									</h4>
									<p id="productDescription">
										<%= products.description %>
									</p>
									<span class="price" id="productPrice">₹ <%= products.price %></span>

									<!-- Size Selection -->
									<div class="mt-3">
										<label for="sizeSelect" class="font-weight-bold">Select Size:</label>
										<select id="sizeSelect" class="form-control">
											<option value="small">Small</option>
											<option value="medium">Medium</option>
											<option value="large">Large</option>
										</select>
									</div>

									<!-- Quantity Selection -->
									<div class="mt-3">
										<label for="quantitySelect" class="font-weight-bold">Quantity:</label>
										<div class="input-group">
											<span class="input-group-btn">
												<button type="button" class="btn btn-danger btn-number"
													data-type="minus" data-field="quantity">
													<span class="glyphicon glyphicon-minus"></span>
												</button>
											</span>
											<input type="text" id="quantitySelect" name="quantity"
												class="form-control input-number" value="1" min="1" max="10">
											<span class="input-group-btn">
												<button type="button" class="btn btn-success btn-number"
													data-type="plus" data-field="quantity">
													<span class="glyphicon glyphicon-plus"></span>
												</button>
											</span>
										</div>
									</div>

									<!-- Add to Cart Button -->
									<div class="mt-4">
										<button type="button" class="btn btn-primary btn-block">Add to Cart</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>


			<!-- SweetAlert2 CSS -->
			<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
			<!-- SweetAlert2 JavaScript -->
			<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
			<!--===============================================================================================-->
			<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/animsition/js/animsition.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/bootstrap/js/popper.js"></script>
			<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/select2/select2.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/daterangepicker/moment.min.js"></script>
			<script src="vendor/daterangepicker/daterangepicker.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/slick/slick.min.js"></script>
			<script src="js/slick-custom.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/parallax100/parallax100.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/isotope/isotope.pkgd.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/sweetalert/sweetalert.min.js"></script>
			<!--===============================================================================================-->
			<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
			<!--===============================================================================================-->
			<script src="js/main.js"></script>
			<!--===============================================================================================-->
			<script src="userjs/home.js"></script>

			<!-- 
			<script>
				const searchInput = document.querySelector('input[name="search-product"]');
				const searchResultsContainer = document.querySelector('.isotope-grid');

				// Debouncing for performance
				let timeout = null;

				searchInput.addEventListener('input', () => {
					clearTimeout(timeout);
					timeout = setTimeout(async () => {
						const query = searchInput.value;
						const response = await fetch(`/product-search?q=${encodeURIComponent(query)}`);
						const products = await response.json();

						// Clear the existing products
						searchResultsContainer.innerHTML = '';

						// Render the products in real-time
						products.forEach(product => {
							searchResultsContainer.innerHTML += `
							<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item ${product.category ? product.category.name : 'uncategorized'}">
								<div class="block2 ${product.stock <= 0 ? 'out-of-stock' : ''}">
									<div class="block2-pic hov-img0 ${product.stock <= 0 ? 'out-of-stock-shade' : ''}">
										${product.images && product.images.length > 0 ?
									`<img src="/uploads/${product.images[0]}" alt="IMG-PRODUCT">` :
									`<img src="/path/to/default-image.jpg" alt="Default Image">`
								}
										<a href="/product-detail/${product._id}"
										   class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04"
										   data-id="${product._id}">
											View Details
										</a>
									</div>
									<div class="block2-txt flex-w flex-t p-t-14">
										<div class="block2-txt-child1 flex-col-l">
											<a href="/product-detail/${product._id}"
											   class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
												${product.name}
											</a>
											<span class="stext-105 cl3">
												₹ ${product.price}
											</span>
											${product.stock <= 0 ? '<span class="stext-105 cl3 out-of-stock">Out of Stock</span>' : ''}
										</div>
									</div>
								</div>
							</div>
						`;
						});
					}, 300); // Wait 300ms after user stops typing before sending the request
				});
			</script> -->

</body>

</html>